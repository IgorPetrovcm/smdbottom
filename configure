#!/bin/sh

set -eu

rm -f config.mk

VERSION=$(cat VERSION)
MAJOR=$(cut -d . -f 1 VERSION)
MINOR=$(cut -d . -f 2 VERSION)
PATCH=$(cut -d . -f 3 VERSION)

include_dir=$PWD/include/
headers=""

for entry in "${include_dir}"*
do 
	headers=$headers"${entry} \ "
done

src_dir=$PWD/src/
objs=""

for entry in "${src_dir}"*
do
	objs=$objs"${entry} \ "
done

cat > config.mk <<-EOF
VERSION="$VERSION"
MAJOR="$MAJOR"
MINOR="$MINOR"
PATCH="$PATCH"
HEADERS="$headers"
OBJS="$objs"
EOF


if [ ! -d build ]
then
	mkdir build
fi
